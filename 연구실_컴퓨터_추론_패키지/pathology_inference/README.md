# λ³‘λ¦¬ μ΄λ―Έμ§€ μ¶”λ΅  ν¨ν‚¤μ§€ (κµμ΅μ› μ»΄ν“¨ν„°μ©)

κµμ΅μ› μ»΄ν“¨ν„°μ—μ„ λ³‘λ¦¬ μ΄λ―Έμ§€ μ¶”λ΅ μ„ μ‹¤ν–‰ν•λ” HTTP API μ›μ»¤ ν¨ν‚¤μ§€μ…λ‹λ‹¤.

## π“‹ κ°μ”

μ΄ ν¨ν‚¤μ§€λ” GCP Django μ„λ²„μ HTTP APIλ¥Ό ν΄λ§ν•μ—¬ μ¶”λ΅  μ”μ²­μ„ λ°›μ•„ μ²λ¦¬ν•©λ‹λ‹¤.

- β… HTTP API λ°©μ‹ (κ³µμ  λ””λ ‰ν† λ¦¬ λ¶ν•„μ”)
- β… μΈν„°λ„· μ—°κ²°λ§ μμΌλ©΄ μ‘λ™
- β… μλ™ μ”μ²­ μ²λ¦¬
- β… κ²°κ³Ό μλ™ μ—…λ΅λ“

## π€ λΉ λ¥Έ μ‹μ‘

```bash
# 1. ν™κ²½ μ„¤μ •
cp env.example .env
nano .env  # μ„¤μ • μμ •

# 2. μμ΅΄μ„± μ„¤μΉ
pip install -r requirements.txt

# 3. μ›μ»¤ μ‹¤ν–‰
python local_inference_worker_http.py
```

μμ„Έν• λ‚΄μ©μ€ [μλ™ν™”_λΉ λ¥Έ_μ‹μ‘.md](μλ™ν™”_λΉ λ¥Έ_μ‹μ‘.md)λ¥Ό μ°Έκ³ ν•μ„Έμ”.

## π“ νμΌ κµ¬μ΅°

```
pathology_inference/
β”β”€β”€ local_inference_worker_http.py  # HTTP API μ›μ»¤ (λ©”μΈ)
β”β”€β”€ local_inference.py               # λ΅μ»¬ μ¶”λ΅  ν•¨μ
β”β”€β”€ env.example                      # ν™κ²½ λ³€μ μμ‹
β”β”€β”€ requirements.txt                 # Python μμ΅΄μ„±
β”β”€β”€ README.md                        # μ΄ νμΌ
β”β”€β”€ μλ™ν™”_λΉ λ¥Έ_μ‹μ‘.md              # λΉ λ¥Έ μ‹μ‘ κ°€μ΄λ“
β”β”€β”€ HTTP_API_λ°©μ‹_μ„¤μ •_κ°€μ΄λ“.md     # μƒμ„Έ μ„¤μ • κ°€μ΄λ“
β””β”€β”€ src/                             # μ†μ¤ μ½”λ“
    β”β”€β”€ models/                       # λ¨λΈ μ½”λ“ (CLAM λ¨λΈ ν†µν•© ν•„μ”)
    β””β”€β”€ best_model.pth               # λ¨λΈ νμΌ
```

## β™οΈ ν™κ²½ λ³€μ

`.env` νμΌμ— λ‹¤μ λ³€μλ“¤μ„ μ„¤μ •ν•μ„Έμ”:

```bash
# Django API μ„¤μ •
DJANGO_API_URL=http://34.42.223.43/api/pathology

# Orthanc μ„λ²„ μ„¤μ •
ORTHANC_URL=http://34.42.223.43:8042
ORTHANC_USER=admin
ORTHANC_PASSWORD=admin123

# λ¨λΈ νμΌ κ²½λ΅
MODEL_PATH=src/best_model.pth

# μ¶”λ΅  μ„¤μ •
DEVICE=cuda  # λλ” cpu

# μ›μ»¤ μ„¤μ •
POLL_INTERVAL=30  # ν΄λ§ κ°„κ²© (μ΄)

# SVS νμΌ μ €μ¥ κ²½λ΅
SVS_STORAGE_DIR=/home/shrjsdn908/pathology_images
```

## π”„ λ™μ‘ νλ¦„

1. μ›μ»¤κ°€ 30μ΄λ§λ‹¤ Django APIλ¥Ό ν΄λ§
2. λ€κΈ° μ¤‘μΈ μ”μ²­ λ°κ²¬ μ‹ μλ™ μ²λ¦¬
3. Orthancμ—μ„ μ›λ³Έ SVS νμΌ κ²½λ΅ μ°ΎκΈ°
4. CLAM λ¨λΈλ΅ μ¶”λ΅  μ‹¤ν–‰
5. κ²°κ³Όλ¥Ό Django APIλ΅ μ—…λ΅λ“

## π“΅ API μ—”λ“ν¬μΈνΈ

μ›μ»¤κ°€ μ‚¬μ©ν•λ” Django API μ—”λ“ν¬μΈνΈ:

- `GET /api/pathology/pending-requests/` - λ€κΈ° μ¤‘μΈ μ”μ²­ κ°€μ Έμ¤κΈ°
- `POST /api/pathology/update-status/{request_id}/` - μƒνƒ μ—…λ°μ΄νΈ
- `POST /api/pathology/complete-request/{request_id}/` - κ²°κ³Ό μ—…λ΅λ“

## β οΈ μ£Όμμ‚¬ν•­

**μ¤‘μ”:** ν„μ¬ μ›μ»¤ κµ¬μ΅°λ” μ™„μ„±λμ—μΌλ‚, μ‹¤μ  CLAM λ¨λΈ μ¶”λ΅  μ½”λ“λ” μ•„μ§ ν†µν•©λμ§€ μ•μ•μµλ‹λ‹¤.

**ν†µν•© ν•„μ”:**
1. CLAM λ¨λΈ μ½”λ“λ¥Ό `src/models/clam_model.py`μ— μ¶”κ°€
2. `local_inference.py`μ `run_clam_inference()` ν•¨μμ— μ‹¤μ  μ¶”λ΅  λ΅μ§ κµ¬ν„

## π”§ λ¬Έμ  ν•΄κ²°

μμ„Έν• λ¬Έμ  ν•΄κ²° λ°©λ²•μ€ [HTTP_API_λ°©μ‹_μ„¤μ •_κ°€μ΄λ“.md](HTTP_API_λ°©μ‹_μ„¤μ •_κ°€μ΄λ“.md)λ¥Ό μ°Έκ³ ν•μ„Έμ”.

## π“ μ°Έκ³  λ¬Έμ„

- [μλ™ν™”_λΉ λ¥Έ_μ‹μ‘.md](μλ™ν™”_λΉ λ¥Έ_μ‹μ‘.md) - λΉ λ¥Έ μ‹μ‘ κ°€μ΄λ“
- [HTTP_API_λ°©μ‹_μ„¤μ •_κ°€μ΄λ“.md](HTTP_API_λ°©μ‹_μ„¤μ •_κ°€μ΄λ“.md) - μƒμ„Έ μ„¤μ • κ°€μ΄λ“

## π“ λΌμ΄μ„ μ¤

μ΄ ν”„λ΅μ νΈλ” μ—°κµ¬ λ©μ μΌλ΅ μ‚¬μ©λ©λ‹λ‹¤.

# OCS 시스템 흐름 및 역할별 기능

## 전체 의료 시스템 흐름

```
1. 환자 접수 (원무과)
   ↓
2. 진료 (의사)
   ↓
3. 처방/검사/영상 주문 생성 (의사) → OCS
   ↓
4. 자동 검증 (약물 상호작용, 알레르기)
   ↓
5. 주문 전달 (의사)
   ↓
6. 부서별 처리
   - 약국: 처방전 조제
   - 검사실: 검사 수행
   - 방사선과: 영상 촬영
   ↓
7. 완료 처리 (부서 담당자)
   ↓
8. 결과 확인 (의사/환자)
```

## 역할별 OCS 기능

### 1. 의사 (호흡기내과, 외과, 영상의학과 등)
- ✅ 주문 생성 (처방전/검사/영상촬영)
- ✅ 자신이 생성한 주문 조회
- ✅ 주문 전달 (검증 통과 후)
- ✅ 주문 취소
- ✅ 환자별 주문 이력 확인

**보이는 주문:**
- 자신이 생성한 모든 주문
- 자신의 환자 주문 (추후 확장)

### 2. 방사선과/영상의학과
- ✅ 영상 촬영 주문 조회
- ✅ 주문 처리 시작
- ✅ 촬영 완료 처리
- ❌ 주문 생성 불가 (의사만 가능)

**보이는 주문:**
- `target_department='radiology'`이고 `order_type='imaging'`인 주문만

### 3. 검사실 (LIS 연동 예정)
- ✅ 검사 주문 조회
- ✅ 주문 처리 시작
- ✅ 검사 완료 처리
- ❌ 주문 생성 불가

**보이는 주문:**
- `target_department='lab'`이고 `order_type='lab_test'`인 주문만

### 4. 약국 (추후 연동)
- ✅ 처방전 조회
- ✅ 조제 완료 처리
- ❌ 주문 생성 불가

**보이는 주문:**
- `target_department='pharmacy'`이고 `order_type='prescription'`인 주문만

### 5. 원무과
- ✅ 모든 주문 조회
- ✅ 주문 통계 확인
- ✅ 주문 취소 (관리 목적)
- ❌ 주문 생성 불가 (의사만 가능)

**보이는 주문:**
- 모든 주문 (필터링 없음)

## 주문 상태 흐름

```
pending (대기중)
  ↓ [의사: 전달]
sent (전달됨)
  ↓ [부서: 처리 시작]
processing (처리중)
  ↓ [부서: 완료]
completed (완료)
```

또는

```
pending (대기중)
  ↓ [의사/원무과: 취소]
cancelled (취소)
```

## 우선순위별 처리

1. **응급 (emergency)**: 즉시 처리 필요
2. **즉시 (stat)**: 빠른 처리 필요
3. **긴급 (urgent)**: 우선 처리
4. **일반 (routine)**: 일반 순서대로 처리

## 자동 검증 시스템

### 약물 상호작용 체크
- 처방전 생성 시 자동 실행
- 심각한 상호작용 발견 시 주문 전달 불가
- 경미/중등도 상호작용은 경고만 표시

### 알레르기 체크
- 환자 알레르기 정보와 주문 항목 비교
- 알레르기 위험 발견 시 주문 전달 불가
- 조영제 사용 시 요오드 알레르기 체크

## 다음 단계 (2-4주차)

### 2주차: RIS 연동
- 영상 촬영 주문 → RIS 스케줄 자동 생성
- Orthanc 연동
- 촬영 완료 시 자동 알림

### 3주차: LIS 연동
- 검사 주문 → LIS 자동 전달
- 검사 결과 자동 업데이트
- 이상 결과 자동 알림

### 4주차: 시스템 통합
- OCS → RIS → LIS 전체 흐름
- 실시간 알림 (WebSocket)
- 대시보드 통합
